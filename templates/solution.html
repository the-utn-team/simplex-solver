<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Resultado - Simplex Solver</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container container-solution">
        <h1>Resultado del Método Simplex</h1>

        <!-- Tu código original para mostrar la solución de Scipy -->
        {% if solucion %}
            <h3>Estado:</h3>
            <p class="preview-text">{{ solucion['solucion_encontrada']['status'] }}</p>

            {% if solucion['solucion_encontrada']['valores_variables'] %}
            <h3>Variables:</h3>
            <div class="preview-text">
                {% for var, val in solucion['solucion_encontrada']['valores_variables'].items() %}
                    {{ var }} = {{ "%.4f"|format(val) }}{% if not loop.last %}, {% endif %}
                {% endfor %}
            </div>

            <h3>Valor Óptimo (Z):</h3>
            <p class="preview-text">{{ "%.4f"|format(solucion['solucion_encontrada']['valor_optimo_z']) }}</p>
            {% else %}
            <p class="preview-text">No se encontró una solución factible.</p>
            {% endif %}
        {% else %}
            <p class="preview-text">Error: No hay datos de solución disponibles.</p>
        {% endif %}
        <!-- Fin de tu código original -->


        <!-- 
          INICIO: Bloque añadido para Gilp
        -->
        <h3 style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
            Visualización de tablas intermedias
        </h3>

        {% if solucion.visualizacion_gilp_html %}
            <!-- 
              El filtro |safe es CRUCIAL. 
            -->
            <div class="gilp-container">
                {{ solucion.visualizacion_gilp_html | safe }}
            </div>

        {% else %}
            <p class="preview-text">
                (Visualización no disponible para este problema).
            </p>
        {% endif %}
        <!-- FIN: Bloque añadido para Gilp -->


        <!-- Tu botón original -->
        <div class="button-group">
            <a href="{{ url_for('ui.index') }}" class="btn-secondary">← Nuevo problema</a>
            
            <!-- --- INICIO DE CAMBIOS (exportación en pdf) --- -->
            <!-- Añadimos el botón de PDF -->
            <a href="{{ url_for('ui.exportar_pdf') }}" class="btn-primary" style="margin-left: 10px;" target="_blank">
                Exportar a PDF
            </a>
            <!-- --- FIN DE CAMBIOS --- -->

        </div>
    </div>
</body>
</html>